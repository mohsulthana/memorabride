<template>
  <div>
    <div class="container">
      <div class="columns is-vcentered is-mobile">
        <div class="column is-half-desktop">
          <img src="../../public/model.jpg" alt="" />
        </div>
        <div class="column is-vcentered is-mobile">
          <div class="container">
            <h1 class="product-title">ABBA DRESS</h1>
            <h2 class="price">$300 USD</h2>
            <div class="columns">
              <div class="column">
                <button class="btn-outline">ADD TO CART</button>
              </div>
              <div class="column">
                <button class="btn-primary">BUY IT NOW</button>
              </div>
            </div>
            <button class="btn-dark" @click="isImageModalActive = true">
              TRY IT ON YOU
            </button>
          </div>
          <p class="text-content">
            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Ipsa sit
            impedit maxime odio reiciendis consequuntur ipsum sed, sint,
            excepturi non dolores. Odio maxime id dicta praesentium ipsam vero
            reiciendis corrupti.
          </p>
          <p class="text-content">COLOR SHOWN IN</p>
          <br />
          <p class="text-content">Ivory/Nude</p>
          <div class="has-text-centered">
            <b-button type="is-primary" icon-left="facebook">Share</b-button>
            <b-button type="is-primary" icon-left="twitter">Tweet</b-button>
            <b-button type="is-primary" icon-left="pinterest">Pin it</b-button>
          </div>
        </div>
      </div>

      <b-modal :active.sync="isImageModalActive">
        <div class="card has-text-centered">
          <div class="card-content">
            <p class="title">
              Upload a full body image
            </p>
            <p class="subtitle">
              Make sure you wear skin-tight clothing for accurare results!
            </p>
            <template v-if="!imageResult">
              <svg
                width="144"
                height="507"
                viewBox="0 0 144 507"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M140.226 245.351C140.226 244.464 140.115 243.91 140.004 243.134C138.676 236.26 137.459 235.928 136.463 219.741C135.135 198.233 132.036 190.029 129.048 180.272C128.384 178.277 127.72 176.392 127.167 174.729C127.056 171.735 126.503 168.742 126.392 166.968C125.175 156.325 125.95 152.112 125.728 148.342C125.507 144.24 124.179 115.193 123.072 109.206C120.195 94.461 111.895 92.4654 106.362 92.9089L105.145 92.5763C105.145 92.5763 105.145 92.5763 105.145 92.6872C102.489 92.1328 99.6112 91.3568 96.8445 90.3589C93.1926 89.1394 89.9832 87.5873 88.1019 85.7025C85.7779 83.1526 85.1139 80.0483 85.1139 77.1658C85.1139 76.2788 85.2246 74.0615 85.3353 72.2876C86.4419 71.0681 87.4379 69.7377 88.4339 67.9638C88.8766 67.9638 94.9632 67.742 96.0699 63.7508C96.0699 64.6378 96.1805 64.7486 95.7379 66.079C99.5005 64.416 101.05 61.4226 101.603 58.0966C102.378 61.6443 101.493 62.5313 101.493 62.5313C107.579 59.2053 105.808 50.6685 105.808 50.6685C107.911 53.2184 107.579 57.8749 107.579 57.8749C113.887 48.7838 105.808 35.3688 109.239 41.4665C113.112 48.4512 111.784 52.9967 111.784 52.9967C119.42 33.7058 97.3979 11.9758 97.3979 11.865C96.2912 10.7563 95.1845 9.64764 94.0779 8.7607C88.7659 3.88255 81.13 1 72.7193 1H70.838C62.3167 1 54.7914 3.88255 49.4795 8.7607C48.2621 9.75851 47.1555 10.7563 46.1595 11.865C46.1595 11.865 24.1369 33.7058 31.7729 52.9967C31.7729 52.9967 30.5556 48.562 34.3182 41.4665C37.6382 35.258 29.5596 48.7838 35.9782 57.8749C35.9782 57.8749 35.6462 53.3293 37.7488 50.6685C37.7488 50.6685 35.9782 59.2053 42.0648 62.5313C42.0648 62.5313 41.1795 61.6443 41.9542 58.0966C42.5075 61.4226 44.0568 64.416 47.8195 66.079C47.3768 64.7486 47.4875 64.6378 47.4875 63.7508C48.4835 67.742 54.6808 67.9638 55.1234 67.9638C56.1194 69.6268 57.1154 70.9572 58.2221 72.1767C58.4434 73.5071 58.4434 75.8353 58.4434 77.0549C58.4434 79.9374 57.7794 83.0417 55.4554 85.5917C54.4594 86.5895 53.1314 87.4764 51.5821 88.3633C51.5821 88.3633 51.5821 88.3633 51.6928 88.3633C50.2541 89.1394 48.5941 89.8046 46.9341 90.3589C44.1675 91.2459 41.2902 92.022 38.6342 92.6872C38.6342 92.6872 38.0808 92.798 37.4168 92.9089C31.8835 92.4654 23.5836 94.461 20.5956 109.206C19.3783 115.193 18.161 144.351 17.9396 148.342C17.7183 152.223 18.493 156.325 17.2756 166.968C17.0543 168.631 16.501 171.625 16.501 174.729C15.837 176.392 15.2836 178.166 14.6196 180.272C11.521 190.029 8.533 198.122 7.20501 219.741C6.20901 235.928 4.99169 236.26 3.6637 243.134C3.55303 243.91 3.55303 244.575 3.6637 245.351C3.11037 249.786 2.88903 252.225 2.6677 253.334C2.0037 256.327 0.897043 259.764 1.00771 262.979C1.11838 266.194 1.11838 267.636 1.33971 270.296C1.78237 275.951 0.565044 275.396 3.3317 279.166C4.54902 280.829 7.64767 287.813 9.97166 287.481C11.189 287.37 11.7423 286.705 11.7423 285.485C11.6317 283.046 8.42234 277.724 8.31167 276.283C7.97967 271.738 6.76235 269.188 9.75033 264.642C9.97166 264.31 10.857 273.29 11.2997 274.398C12.4063 277.503 14.841 277.392 15.505 274.177C16.501 269.853 16.0583 267.414 16.6116 262.092C17.0543 258.101 16.7223 254.886 15.837 251.782C15.0623 249.342 14.6196 247.347 14.3983 245.13C14.3983 245.13 14.3983 244.464 14.509 244.132C15.6156 238.699 18.0503 230.052 20.2636 222.956C25.2436 207.435 29.4489 201.004 30.5556 179.164C31.5516 176.503 32.2155 172.844 32.6582 167.522C33.1009 162.866 34.4289 156.99 35.7569 150.227C36.3102 151.779 36.8635 153.221 37.4168 154.773C37.4168 154.884 37.6382 154.994 37.7488 155.216C38.4128 157.323 38.9662 159.318 39.4088 161.536C40.0728 165.416 41.4008 173.177 41.2902 180.605C41.1795 186.924 39.6302 193.022 38.6342 196.126C37.9702 198.122 37.0849 201.115 35.9782 204.774C34.7609 208.876 33.3222 213.754 31.7729 218.965C31.4409 219.963 31.1089 221.182 30.6662 222.402C30.5556 222.402 26.2396 237.812 26.4609 238.034C25.3542 244.021 24.5796 251.116 25.0223 259.321C25.3542 265.751 26.1289 281.05 27.5676 295.796C28.3422 303.667 30.4449 317.193 32.3262 331.606C34.4289 347.903 36.3102 365.642 35.3142 377.172C34.3182 388.259 31.6622 402.007 32.2155 413.093C32.7689 424.18 37.3062 440.478 39.2982 451.232C39.5195 452.451 42.9502 470.19 42.6182 472.186C41.8435 476.509 43.1715 478.727 43.6142 479.614C44.8315 482.274 41.4008 487.263 39.5195 491.809C38.3022 494.913 36.9742 497.796 38.5235 499.57C41.4008 502.896 46.9341 505.889 50.6968 506C50.8074 506 50.8074 506 50.9181 506C53.0208 506 53.7954 505.113 54.7914 504.115C55.7874 503.117 56.4514 502.12 56.8941 501.233C57.1154 500.678 57.3367 500.124 57.4474 499.57C57.6687 498.572 57.6687 497.574 57.6687 496.465C57.5581 492.918 57.1154 489.037 56.7834 486.598C56.6727 486.155 56.6727 485.822 56.6727 485.379C56.5621 484.381 56.5621 483.494 56.5621 482.718C56.5621 478.727 57.5581 476.177 56.0088 471.52C55.4554 469.636 54.6808 465.201 54.5701 461.653C54.5701 460.766 54.4594 459.879 54.5701 459.103C55.0128 448.349 57.2261 418.415 57.4474 407.661C57.4474 405.665 57.4474 403.78 57.3367 401.896C56.8941 392.694 55.4554 383.935 57.6687 375.731C60.2141 365.864 63.866 324.954 65.194 315.752C66.6327 305.441 67.6287 278.501 68.9567 268.079C70.9487 268.744 73.2727 268.744 74.9327 268.19C76.2606 278.722 77.2566 305.441 78.6953 315.752C80.0233 325.065 83.6753 365.864 86.2206 375.731C88.3233 383.935 86.9953 392.694 86.5526 401.896C86.4419 403.78 86.4419 405.776 86.4419 407.661C86.6633 418.415 88.8766 448.349 89.3192 459.103C89.3192 459.879 89.3192 460.655 89.3192 461.653C89.0979 465.201 88.4339 469.746 87.8806 471.52C86.3313 476.288 87.3273 478.727 87.3273 482.718C87.3273 483.494 87.3273 484.381 87.2166 485.379C87.2166 485.711 87.1059 486.155 87.1059 486.598C86.7739 489.148 86.3313 493.029 86.2206 496.465C86.2206 497.574 86.2206 498.572 86.4419 499.57C86.6633 500.124 86.7739 500.789 86.9953 501.233C87.4379 502.12 88.1019 503.007 89.0979 504.115C90.0939 505.113 90.8686 506 92.9712 506C93.0819 506 93.0819 506 93.1926 506C96.9552 505.889 102.489 502.896 105.366 499.57C106.915 497.796 105.587 494.913 104.37 491.809C102.489 487.263 98.9472 482.274 100.275 479.614C100.718 478.727 102.046 476.398 101.271 472.186C100.939 470.19 104.37 452.451 104.591 451.232C106.583 440.478 111.12 424.18 111.674 413.093C112.227 402.007 109.571 388.259 108.575 377.172C107.579 365.531 109.35 347.903 111.563 331.606C113.444 317.193 115.547 303.557 116.322 295.796C117.76 281.161 118.535 265.751 118.867 259.321C119.31 251.116 118.646 244.021 117.428 238.034C117.65 237.923 115.879 229.276 113.334 222.402C112.891 221.182 112.559 220.074 112.227 219.076C110.678 213.865 109.239 208.987 108.022 204.885C106.915 201.226 105.919 198.122 105.366 196.237C104.37 193.133 102.931 187.035 102.71 180.716C102.599 173.288 103.817 165.416 104.591 161.647C105.034 159.318 105.587 157.323 106.251 155.327C106.472 155.216 106.583 155.105 106.583 154.884C107.136 153.331 107.69 151.89 108.243 150.338C109.571 156.99 111.01 162.977 111.342 167.633C111.784 172.955 112.559 176.724 113.444 179.274C114.551 201.115 118.756 207.546 123.736 223.067C125.95 230.052 128.495 238.81 129.491 244.243C129.602 244.575 129.602 245.24 129.602 245.24C129.38 247.458 128.938 249.453 128.163 251.892C127.167 254.997 126.946 258.212 127.388 262.203C127.942 267.525 127.61 270.075 128.495 274.288C129.159 277.503 131.704 277.614 132.7 274.509C133.143 273.401 134.028 264.42 134.25 264.753C137.238 269.409 136.02 271.849 135.688 276.394C135.578 277.724 132.368 283.046 132.258 285.596C132.147 286.816 132.811 287.481 134.028 287.592C136.463 287.813 139.562 280.829 140.668 279.277C143.435 275.507 142.218 276.061 142.66 270.407C142.882 267.746 142.882 266.305 142.992 263.09C143.103 259.875 141.996 256.438 141.332 253.445C140.668 252.225 140.668 249.786 140.226 245.351Z"
                  stroke="black"
                  stroke-width="2"
                  stroke-miterlimit="10"
                />
              </svg>
            </template>
            <template v-else>
              <img :src="'data:image/png;base64, ' + imageResult" alt="" />
            </template>
            <p>Forward Facing</p>
            <p>Standing Pose</p>
            <input
              type="file"
              ref="src"
              style="display: none"
              v-on:change="srcImage($event)"
            />
            <button
              class="btn-dark"
              style="max-width: 50%"
              @click="$refs.src.click()"
            >
              SRC
            </button>
            <input
              type="file"
              ref="tgt"
              style="display: none"
              v-on:change="tgtImage($event)"
            />
            <button
              class="btn-dark"
              style="max-width: 50%"
              @click="$refs.tgt.click()"
            >
              TGT
            </button>
            <button
              class="btn-dark"
              style="background: #a99c7d; border: 1px solid #a99c7d"
              @click="upload()"
            >
              UPLOAD
            </button>
            <!-- <uploader
              ref="uploader"
              :autoStart="false"
              @file-progress="onFileProgress"
              @file-added="onFileAdded"
              :options="options"
              class="uploader-example"
            >
              <uploader-unsupport></uploader-unsupport>
              <uploader-drop>
                <p>UPLOAD FROM DEVICE</p>
                <uploader-btn @click="srcImage($event)" :attrs="attrs"
                  >src images</uploader-btn
                >
                <uploader-btn @click="tgtImage($event)" :attrs="attrs"
                  >tgt images</uploader-btn
                >
              </uploader-drop>
            </uploader> -->
          </div>
        </div>
      </b-modal>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      srcFile: '',
      tgtFile: '',
      imageResult: '',
      isImageModalActive: false,
      options: {
        // https://github.com/simple-uploader/Uploader/tree/develop/samples/Node.js
        target: 'https://api-pod7.colab.proneer.co/api/swap/upload_src',
        testChunks: false
      },
      attrs: {
        accept: 'image/*'
      }
    }
  },
  methods: {
    upload() {
      fetch('https://api-pod7.colab.proneer.co/api/swap/upload_src', {
        method: 'POST',
        body: this.srcFile
      }).then(response => {
        console.log(response)
        fetch('https://api-pod7.colab.proneer.co/api/swap/upload_tgt', {
          method: 'POST',
          body: this.tgtFile
        }).then(response => {
          console.log(response)
          fetch('https://api-pod7.colab.proneer.co/api/swap', { method: 'GET' })
            .then(response => response.json())
            .then(data => {
              this.imageResult = data
              console.log(this.imageResult)
            })
            .catch(error => console.log(error))
        })
      })
    },
    onFileProgress(rootFile, file, chunk) {
      console.log(
        `上传中 ${file.name}，chunk：${chunk.startByte /
          1024 /
          1024} ~ ${chunk.endByte / 1024 / 1024}`
      )
    },
    // onFileAdded(event) {
    //   var file = event.file
    //   var reader = new FileReader()
    //   reader.onloadend = function() {
    //     // console.log('Encoded Base 64 File String:', reader.result)
    //     /******************* for Binary ***********************/
    //     // var data = reader.result.split(',')[1]
    //     // var binaryBlob = atob(data)
    //     // console.log('Encoded Binary File String:', binaryBlob)
    //   }
    //   reader.readAsDataURL(file)

    //   // this.$store
    //   //   .dispatch('event/createEvent', this.event)
    //   //   .then(() => {
    //   //     this.$router.push({
    //   //       name: 'event-show',
    //   //       params: { id: this.event.id }
    //   //     })
    //   //     this.event = this.createFreshEventObject()
    //   //   })
    //   //   .catch((error) => {
    //   //     console.error(error);
    //   //   })
    // },
    tgtImage(event) {
      this.tgtFile = event.srcElement.files[0]
    },
    srcImage(event) {
      this.srcFile = event.srcElement.files[0]
    }
  }
}
</script>
